{"version":3,"file":"three-6dof.js","sources":["../src/uniforms.ts","../src/index.ts"],"sourcesContent":["import {\n    Vector2,\n    Vector4\n} from 'three'\n\nconst Uniforms = {\n    'map': {\n        type: 't',\n        value: null\n    },\n    'depthMap': {\n        type: 't',\n        value: null\n    },\n    'time': {\n        type: 'f',\n        value: 0.0\n    },\n    'opacity': {\n        type: 'f',\n        value: 1.0\n    },\n    'pointSize': {\n        type: 'f',\n        value: 3.0\n    },\n    'debugDepth': {\n        type: 'f',\n        value: 0.0\n    },\n    'isSeperate': {\n        type: 'b',\n        value: false\n    }\n}\n\nexport default Uniforms","import {\n    Object3D,\n    Material,\n    ShaderMaterial,\n    TextureLoader,\n    BackSide,\n    Mesh,\n    Points,\n    SphereBufferGeometry\n} from 'three'\n\n// Load shaders\nimport frag from './shaders/sixdof.frag'\nimport vert from './shaders/sixdof.vert'\n\nimport Uniforms from './uniforms'\n\nenum TextureType {\n    TOP_BOTTOM,\n    SEPERATE\n}\n\nenum MeshDensity {\n    LOW = 64,\n    MEDIUM = 128,\n    HIGH = 256,\n    EXTRA_HIGH = 512\n}\n\nenum Style {\n    WIRE,\n    POINTS,\n    MESH\n}\n\nclass Viewer extends Object3D {\n    public props: object\n    protected loader: TextureLoader = new TextureLoader()\n    protected obj: Object3D\n    protected geometry: SphereBufferGeometry\n    protected material: Material = new ShaderMaterial({\n        uniforms: Uniforms,\n        vertexShader: vert,\n        fragmentShader: frag,\n        transparent: true,\n        side: BackSide\n    })\n\n    constructor(\n        texturePath: string = undefined,\n        depthPath?: string,\n        textureType: TextureType = TextureType.SEPERATE,\n        meshDensity: MeshDensity = MeshDensity.EXTRA_HIGH,\n        style: Style = Style.MESH,\n        displacement: number = 1\n    ) {\n        super()\n\n        if (!texturePath) throw new Error('Texture path must be defined when creating a viewer')\n\n        this.geometry = new SphereBufferGeometry(10, meshDensity, meshDensity)\n\n        if (textureType === TextureType.SEPERATE) {\n            if (!depthPath) throw new Error('When using seperate textures you must provide a depth texture as well')\n\n            // Inform the shader we are providing two seperate textures\n            this.material.uniforms.isSeperate.value = true\n\n            // Load the depth map\n            this.load(depthPath)\n                .then(texture => {\n                    this.material.uniforms.depthMap.value = texture\n                })\n                .catch(err => { throw new Error(err) })\n        }\n\n        // Load the texture\n        this.load(texturePath)\n            .then(texture => {\n                this.material.uniforms.map.value = texture\n            })\n            .catch(err => { throw new Error(err) })\n\n        // Create the Mesh/Points and add it to the viewer object\n        this.obj = this.createSceneObjectWithStyle(style)\n        this.add(this.obj)\n    }\n\n    protected createSceneObjectWithStyle(style: Style): Object3D {\n        switch (style) {\n            case Style.WIRE:\n                this.material.wireframe = true\n            case Style.MESH:\n                return new Mesh(this.geometry, this.material)\n            case Style.POINTS:\n                return new Points(this.geometry, this.material)\n        }\n    }\n\n    protected load(texturePath: string): Promise<string> {\n        return new Promise((resolve, reject) => {\n            this.loader.load(\n                texturePath,\n                texture => resolve(texture),\n                undefined,\n                () => reject(`Error loading texture error`)\n            )\n        })\n    }\n}\n\nexport { Viewer, TextureType }"],"names":["Uniforms","type","value","TextureType","MeshDensity","Style","Viewer","Object3D","constructor","texturePath","undefined","depthPath","textureType","SEPERATE","meshDensity","EXTRA_HIGH","style","MESH","props","loader","TextureLoader","obj","geometry","material","ShaderMaterial","uniforms","vertexShader","vert","fragmentShader","frag","transparent","side","BackSide","Error","SphereBufferGeometry","isSeperate","load","then","texture","depthMap","err","map","createSceneObjectWithStyle","add","WIRE","wireframe","Mesh","POINTS","Points","Promise","resolve","reject"],"mappings":"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"}